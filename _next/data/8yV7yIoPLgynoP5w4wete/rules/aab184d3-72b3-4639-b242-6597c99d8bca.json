{"pageProps":{"rule":{"metadata":{"creation_date":"2023/05/22","maturity":"production","updated_date":"2023/06/27","min_stack_comments":"Limiting the backport of these rules to the stack version which we are deprecating the Threat Intel Indicator Match\ngeneral rules.\n","min_stack_version":"8.5.0"},"rule":{"author":["Elastic"],"description":"This rule is triggered when a hash indicator from the Threat Intel Filebeat module or integrations has a match against an\nevent that contains file hashes, such as antivirus alerts, process creation, library load, and file operation events.\n","from":"now-65m","index":["auditbeat-*","endgame-*","filebeat-*","logs-*","winlogbeat-*"],"interval":"1h","language":"kuery","license":"Elastic License v2","name":"Threat Intel Hash Indicator Match","references":["https://www.elastic.co/guide/en/beats/filebeat/current/filebeat-module-threatintel.html","https://www.elastic.co/guide/en/security/master/es-threat-intel-integrations.html","https://www.elastic.co/security/tip"],"risk_score":99,"rule_id":"aab184d3-72b3-4639-b242-6597c99d8bca","severity":"critical","tags":["OS: Windows","Data Source: Elastic Endgame","Rule Type: Indicator Match"],"timeline_id":"495ad7a7-316e-4544-8a0f-9c098daee76e","timeline_title":"Generic Threat Match Timeline","type":"threat_match","threat_index":["filebeat-*","logs-ti_*"],"threat_indicator_path":"threat.indicator","threat_language":"kuery","threat_query":"@timestamp >= \"now-30d/d\" and event.module:(threatintel or ti_*) and\n  (threat.indicator.file.hash.*:* or threat.indicator.file.pe.imphash:*) and \n  not labels.is_ioc_transform_source:\"true\"\n","query":"file.hash.*:* or file.pe.imphash:*  or process.hash.*:* or process.pe.imphash:* or dll.hash.*:* or dll.pe.imphash:* \n","threat_filters":[{"$state":{"store":"appState"},"meta":{"negate":false,"disabled":false,"type":"phrase","key":"event.category","params":{"query":"threat"}},"query":{"match_phrase":{"event.category":"threat"}}},{"$state":{"store":"appState"},"meta":{"negate":false,"disabled":false,"type":"phrase","key":"event.kind","params":{"query":"enrichment"}},"query":{"match_phrase":{"event.kind":"enrichment"}}},{"$state":{"store":"appState"},"meta":{"negate":false,"disabled":false,"type":"phrase","key":"event.type","params":{"query":"indicator"}},"query":{"match_phrase":{"event.type":"indicator"}}}],"threat_mapping":[{"entries":[{"field":"file.hash.md5","type":"mapping","value":"threat.indicator.file.hash.md5"}]},{"entries":[{"field":"file.hash.sha1","type":"mapping","value":"threat.indicator.file.hash.sha1"}]},{"entries":[{"field":"file.hash.sha256","type":"mapping","value":"threat.indicator.file.hash.sha256"}]},{"entries":[{"field":"file.pe.imphash","type":"mapping","value":"threat.indicator.file.pe.imphash"}]},{"entries":[{"field":"dll.hash.md5","type":"mapping","value":"threat.indicator.file.hash.md5"}]},{"entries":[{"field":"dll.hash.sha1","type":"mapping","value":"threat.indicator.file.hash.sha1"}]},{"entries":[{"field":"dll.hash.sha256","type":"mapping","value":"threat.indicator.file.hash.sha256"}]},{"entries":[{"field":"process.hash.md5","type":"mapping","value":"threat.indicator.file.hash.md5"}]},{"entries":[{"field":"process.hash.sha1","type":"mapping","value":"threat.indicator.file.hash.sha1"}]},{"entries":[{"field":"process.hash.sha256","type":"mapping","value":"threat.indicator.file.hash.sha256"}]},{"entries":[{"field":"dll.pe.imphash","type":"mapping","value":"threat.indicator.file.pe.imphash"}]},{"entries":[{"field":"process.pe.imphash","type":"mapping","value":"threat.indicator.file.pe.imphash"}]}]}}},"__N_SSG":true}